// Prisma schema for Flow Blog example

generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

generator flow {
  provider = "node ../../dist/index.js"
  output   = "../lib/flow"
  models   = "all"
  prismaImport = "../prisma"

  userSelect = ["id", "email", "name", "posts", "comments"]
  postSelect = ["id", "title", "content", "author", "comments", "createdAt"]
  commentSelect = ["id", "content", "author", "post", "createdAt"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id        String    @id @default(cuid())
  email     String    @unique
  name      String?
  posts     Post[]
  comments  Comment[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Post {
  id        String    @id @default(cuid())
  title     String
  content   String?
  authorId  String
  author    User      @relation(fields: [authorId], references: [id], onDelete: Cascade)
  comments  Comment[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Comment {
  id        String   @id @default(cuid())
  content   String
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  authorId  String
  author    User     @relation(fields: [authorId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
