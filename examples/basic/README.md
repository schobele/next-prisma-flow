# Flow Blog Example

A minimal blog application showcasing next-prisma-flow features.

## Features Demonstrated

- 📚 **CRUD Operations** - Create, read, update, delete posts
- 🔄 **Advanced Forms** - Split create/update hooks with field-level operations
- 💾 **Autosave** - Per-field save states with visual feedback
- 📝 **Field Tracking** - Monitor changes, dirty fields, and original values
- ↩️ **Undo/Redo** - Form history with configurable size
- 🎯 **Field Operations** - Reset, validate, and batch update individual fields
- 🔐 **Policy-based Auth** - Authors can only edit their own posts
- ⚡ **Optimistic Updates** - Instant UI feedback
- 🎯 **Type Safety** - End-to-end TypeScript with Zod validation
- 📊 **Admin Dashboard** - Stats and post management

## Setup

1. Install dependencies:
```bash
cd examples/basic
npm install
```

2. Set up the database:
```bash
# Generate Prisma client and Flow code
npm run generate

# Push schema to database
npm run db:push

# Seed with sample data
npm run db:seed
```

3. Start the development server:
```bash
npm run dev
```

Visit http://localhost:3000

## Project Structure

```
app/
├── page.tsx              # Home page with post list
├── posts/
│   ├── [id]/
│   │   ├── page.tsx     # View single post
│   │   └── edit/
│   │       └── page.tsx # Edit post (with autosave)
│   └── new/
│       └── page.tsx     # Create new post
└── admin/
    └── page.tsx         # Admin dashboard

components/blog/
├── post-list.tsx        # Uses usePostList hook
├── post-card.tsx        # Post preview card
├── post-form.tsx        # Form with autosave
└── post-view.tsx        # Full post display

lib/
├── flow/                # Generated by next-prisma-flow
│   ├── post/           # Post model operations
│   ├── author/         # Author model operations
│   ├── tag/            # Tag model operations
│   ├── core/           # Runtime utilities
│   └── policies.ts     # Authorization rules
└── auth.ts             # Mock authentication
```

## Key Features

### Advanced Form System
The edit form demonstrates all new features:
- **Split Hooks**: Separate `useCreatePostForm` and `useUpdatePostForm` for better type safety
- **Field Tracking**: Monitor which fields have been modified with original vs current values
- **Autosave**: Individual fields save automatically with debouncing
- **Field-level Save States**: Visual indicators per field (idle/saving/saved/error)
- **Dirty Fields Panel**: Shows all unsaved changes with reset options
- **Undo/Redo History**: Navigate through form state changes
- **Field Operations**: Reset individual fields, batch updates, programmatic validation
- **Progress Tracking**: Visual completion percentage for required fields

### Policy-based Authorization
- Public users can view published posts
- Authors can create/edit/delete their own posts
- Mock auth logs you in as "John Doe"
- Try editing John's posts vs Jane's posts

### Optimistic Updates
- Delete actions update UI immediately
- Create/update mutations show instant feedback
- Automatic rollback on errors

## Testing Different Scenarios

1. **View as Public**: See only published posts on home page
2. **Create Post**: Click "Write" to create a new post
3. **Edit with Autosave**: Edit any of John's posts to see autosave
4. **Authorization**: Try editing Jane's posts (will fail)
5. **Admin View**: Check `/admin` for all posts including drafts

## Mock Authentication

The example uses mock auth (`lib/auth.ts`). You're logged in as:
- Name: John Doe
- ID: demo-author-1
- Role: author

To test different users, modify `getCurrentUser()` in `lib/auth.ts`.

## Learn More

This example demonstrates core next-prisma-flow features. For production apps:
- Replace mock auth with real authentication
- Add proper error boundaries
- Implement pagination for large datasets
- Add image uploads and rich text editing
- Deploy with a production database