// @generated by next-prisma-flow-state-engine
// file: policies.ts

import type { FlowCtx } from "./core";

type PolicyResult = {
  ok: boolean;
  message?: string;
  where?: any;
  data?: any;
};

type PolicyAction = "list" | "read" | "create" | "update" | "delete";

export async function canAuthor(
  action: PolicyAction,
  ctx: FlowCtx,
  id?: string,
): Promise<PolicyResult> {
  // Default: allow all for authenticated users
  if (!ctx.userId) {
    return { ok: false, message: "Authentication required" };
  }

  switch (action) {
    case "list":
    case "read":
      // Tenant filtering if model has tenant field
      return { ok: true, where: {} };

    case "create":
      return { ok: true, data: {} };

    case "update":
    case "delete":
      // Ownership check could be added here
      return { ok: true, where: {} };

    default:
      return { ok: false, message: "Unknown action" };
  }
}

export async function canPost(
  action: PolicyAction,
  ctx: FlowCtx,
  id?: string,
): Promise<PolicyResult> {
  // Default: allow all for authenticated users
  if (!ctx.userId) {
    return { ok: false, message: "Authentication required" };
  }

  switch (action) {
    case "list":
    case "read":
      // Tenant filtering if model has tenant field
      return { ok: true, where: {} };

    case "create":
      return { ok: true, data: {} };

    case "update":
    case "delete":
      // Ownership check could be added here
      return { ok: true, where: {} };

    default:
      return { ok: false, message: "Unknown action" };
  }
}

export async function canTag(
  action: PolicyAction,
  ctx: FlowCtx,
  id?: string,
): Promise<PolicyResult> {
  // Default: allow all for authenticated users
  if (!ctx.userId) {
    return { ok: false, message: "Authentication required" };
  }

  switch (action) {
    case "list":
    case "read":
      // Tenant filtering if model has tenant field
      return { ok: true, where: {} };

    case "create":
      return { ok: true, data: {} };

    case "update":
    case "delete":
      // Ownership check could be added here
      return { ok: true, where: {} };

    default:
      return { ok: false, message: "Unknown action" };
  }
}
