// @generated by next-prisma-flow-state-engine
// file: client/field.tsx

"use client";

import {} from "react";
import { type Path } from "react-hook-form";
import {
  FlowField,
  type FlowFieldProps,
  FlowFieldTransforms,
} from "../../core/field-wrapper";
import { useFlowFormContext } from "../../core/form-provider";
import type { FlowPostCreate, FlowPostUpdate } from "../types/schemas";

/**
 * Valid field names for Post forms
 */
export type PostFieldName = Path<FlowPostCreate> | Path<FlowPostUpdate>;

/**
 * Props for PostFormField component
 */
export interface PostFormFieldProps extends Omit<FlowFieldProps, "name"> {
  /**
   * The field name - type-safe with autocomplete
   */
  name: PostFieldName;
}

/**
 * Type-safe form field for Post
 * Works seamlessly with shadcn/ui form components
 *
 * @example
 * ```tsx
 * <PostFormField
 *   name="title"
 *   render={({ field }) => (
 *     <FormItem>
 *       <FormLabel>Title</FormLabel>
 *       <FormControl>
 *         <Input {...field} />
 *       </FormControl>
 *       <FormDescription>
 *         Enter a descriptive title
 *       </FormDescription>
 *       <FormMessage />
 *     </FormItem>
 *   )}
 * />
 * ```
 */
export function PostFormField({ name, ...props }: PostFormFieldProps) {
  return <FlowField name={name as any} {...props} />;
}

/**
 * Common field transforms for Post
 *
 * @example
 * ```tsx
 * <PostFormField
 *   name="price"
 *   transform={PostFieldTransforms.number}
 *   render={({ field }) => <Input type="number" {...field} />}
 * />
 * ```
 */
export const PostFieldTransforms = {
  /**
   * Transform for date fields
   */
  date: FlowFieldTransforms.dateToISO,

  /**
   * Transform for optional string fields
   */
  optional: FlowFieldTransforms.emptyToNull,

  /**
   * Trim whitespace from text fields
   */
  text: FlowFieldTransforms.trim,
};

/**
 * Hook to get field value and setter
 *
 * @example
 * ```tsx
 * function MyComponent() {
 *   const [title, setTitle] = usePostFieldValue("title");
 *   return <input value={title} onChange={e => setTitle(e.target.value)} />;
 * }
 * ```
 */
export function usePostFieldValue(name: PostFieldName) {
  const { form } = useFlowFormContext();
  const value = form.watch(name as any);
  const setValue = (newValue: any) => {
    form.setValue(name as any, newValue, {
      shouldValidate: true,
      shouldDirty: true,
      shouldTouch: true,
    });
  };
  return [value, setValue] as const;
}

/**
 * Hook to get field state
 *
 * @example
 * ```tsx
 * function MyField() {
 *   const fieldState = usePostFieldState("title");
 *   return (
 *     <div>
 *       {fieldState.isDirty && <span>Modified</span>}
 *       {fieldState.error && <span>{fieldState.error.message}</span>}
 *     </div>
 *   );
 * }
 * ```
 */
export function usePostFieldState(name: PostFieldName) {
  const { form } = useFlowFormContext();
  return form.getFieldState(name as any);
}

/**
 * Hook to get field error
 *
 * @example
 * ```tsx
 * function MyField() {
 *   const error = usePostFieldError("email");
 *   if (error) {
 *     return <span className="text-red-500">{error.message}</span>;
 *   }
 *   return null;
 * }
 * ```
 */
export function usePostFieldError(name: PostFieldName) {
  const { form } = useFlowFormContext();
  const fieldState = form.getFieldState(name as any);
  return fieldState.error;
}
